export default class{constructor(){this.implementedPopups=[],this._popupOpenHandler(),this._popupCloseHandler()}_setDisplayAttr(el,display="block"){el.setAttribute("data-popup-display",display)}_populatePopups(selector){return new Promise((resolve,reject)=>{if(void 0!==this.implementedPopups[selector])return resolve(this.implementedPopups[selector]);document.querySelectorAll(selector).forEach((el,index)=>{void 0===el.open&&(el.open=(e=>{e.preventDefault(),this._setDisplayAttr(el,"open")})),void 0===el.close&&(el.close=(()=>{this._setDisplayAttr(el,"closed")})),this.implementedPopups[selector]=el,resolve(el)})})}_closeParentPopup(e){return e.preventDefault(),null!=this.offsetParent.getAttribute("data-popup-display")?this.offsetParent.close():this.offsetParent.offsetParent.close()}_popupOpenHandler(){document.querySelectorAll("[data-popup-button]").forEach((el,index)=>{var target=el.getAttribute("href");this._populatePopups(target).then(e=>{el.addEventListener("click",e.open)})})}_popupCloseHandler(){document.querySelectorAll("[data-popup-toggle]").forEach((el,index)=>{el.removeEventListener("click",this._closeParentPopup),el.addEventListener("click",this._closeParentPopup)})}};